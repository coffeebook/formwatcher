// Generated by CoffeeScript 1.3.1
((function(){var a,b,c,d=[].slice,e={}.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype
,a.prototype=new d,a.__super__=b.prototype,a};$.ender({fwData:function(a,b){var c;return this.data("_formwatcher")==null&&this.data("_formwatcher",{}),a==null?this:(c=this.data("_formwatcher"),b!=null?
(c[a]=b,this.data("_formwatcher",c),this):c[a])}},!0),c="input, textarea, select, button",a={version:"2.1.2-dev",debugging:!1,debug:function(){if(this.debugging&&(typeof console!=="undefined"&&console!==
null?console.debug:void 0)!=null)return console.debug.apply(console,arguments)},getErrorsElement:function(a,b){var c,d;d=a.input,d.attr("name")&&(c=$("#"+d.attr("name")+"-errors")),(c!=null?c.length:void 0
)||!d.attr("id")||(c=$("#"+d.attr("id")+"-errors"));if(!c||!c.length)c=$.create("<span />"),d.attr("name")&&c.attr("id",d.attr("name")+"-errors"),c.insertAfter(d);return c.hide().addClass("errors").addClass
("fw-errors"),c},deepExtend:function(){var a,b,c,f,g,h,i;c=arguments[0],a=2<=arguments.length?d.call(arguments,1):[];if(c==null)return{};for(h=0,i=a.length;h<i;h++){f=a[h];for(b in f){if(!e.call(f,b))continue;
g=f[b],c[b]==null||typeof g!="object"?c[b]=g:c[b]=this.deepExtend(c[b],g)}}return c},getLabel:function(a,b){var c,d;c=a.input,d=void 0,c.attr("id")&&(d=$("label[for="+c.attr("id")+"]"),d.length||(d=undefined
));if(!d&&b){d=c.previous(),window.testinput=c;if(!d.length||d.get(0).nodeName!=="LABEL"||d.attr("for")!=null)d=void 0}return d},changed:function(b,c){var d;d=b.input;if(!d.fwData("forceValidationOnChange"
)&&d.attr("type")==="checkbox"&&d.fwData("previouslyChecked")===!!d[0].checked||d.fwData("previousValue")===d.val())return;d.fwData("forceValidationOnChange",!1),this.setPreviousValueToCurrentValue(b),
d.attr("type")==="checkbox"&&d.fwData("initialyChecked")!==!!d[0].checked||d.attr("type")!=="checkbox"&&d.fwData("initialValue")!==d.val()?a.setChanged(b,c):a.unsetChanged(b,c);if(c.options.validate)return c
.validateElements(b)},setChanged:function(b,c){var d,f,g;g=b.input;if(g.fwData("changed"))return;for(f in b){if(!e.call(b,f))continue;d=b[f],d.addClass("changed")}g.fwData("changed",!0),c.options.submitUnchanged||
a.restoreName(b);if(c.options.submitOnChange&&c.options.ajax)return c.submitForm()},unsetChanged:function(b,c){var d,f,g;g=b.input;if(!g.fwData("changed"))return;for(f in b){if(!e.call(b,f))continue;d=
b[f],d.removeClass("changed")}g.fwData("changed",!1);if(!c.options.submitUnchanged)return a.removeName(b)},storeInitialValue:function(a){var b;return b=a.input,b.attr("type")==="checkbox"?b.fwData("initialyChecked"
,!!b[0].checked):b.fwData("initialValue",b.val()),this.setPreviousValueToInitialValue(a)},restoreInitialValue:function(a){var b;return b=a.input,b.attr("type")==="checkbox"?b.attr("checked",b.fwData("initialyChecked"
)):b.val(b.fwData("initialValue")),this.setPreviousValueToInitialValue(a)},setPreviousValueToInitialValue:function(a){var b;return b=a.input,b.attr("type")==="checkbox"?b.fwData("previouslyChecked",b.fwData
("initialyChecked")):b.fwData("previousValue",b.fwData("initialValue"))},setPreviousValueToCurrentValue:function(a){var b;return b=a.input,b.attr("type")==="checkbox"?b.fwData("previouslyChecked",!!b[0
].checked):b.fwData("previousValue",b.val())},removeName:function(a){var b;b=a.input;if(b.attr("type")==="checkbox")return;return b.fwData("name")||b.fwData("name",b.attr("name")||""),b.attr("name","")
},restoreName:function(a){var b;b=a.input;if(b.attr("type")==="checkbox")return;return b.attr("name",b.fwData("name"))},decorators:[],decorate:function(b,c){var d,e,f,g,h;e=null,h=b.decorators;for(f=0,
g=h.length;f<g;f++){d=h[f];if(d.accepts(c)){e=d;break}}return e?(a.debug('Decorator "'+e.name+'" found for input field "'+c.attr("name")+'".'),e.decorate(c)):{input:c}},validators:[],currentWatcherId:0
,watchers:[],add:function(a){return this.watchers[a.id]=a},get:function(a){return this.watchers[a]},getAll:function(){return this.watchers},scanDocument:function(){var c,d,e,f=this;d=function(c){var d,
e,g;c=$(c);if(c.fwData("watcher"))return;return e=c.attr("id"),g=e!=null&&a.options[e]!=null?a.options[e]:{},d=c.data("fw"),d&&(g=f.deepExtend(g,JSON.parse(d))),new b(c,g)},$('form[data-fw], form[data-fw=""]'
).each(function(a){return d(a)}),e=[];for(c in a.options)e.push(d($("#"+c)));return e},watch:function(a,c){return $.domReady(function(){return new b(a,c)})}},a._ElementWatcher=function(){function b(b){
var c;this.watcher=b,this.options=a.deepExtend({},this.defaultOptions,(c=b.options[this.name])!=null?c:{})}return b.name="_ElementWatcher",b.prototype.name="No name",b.prototype.description="No description"
,b.prototype.nodeNames=null,b.prototype.classNames=[],b.prototype.defaultOptions={},b.prototype.options=null,b.prototype.accepts=function(a){var b,c,d,e,f,g,h,i,j,k,l;if(this.watcher.options[this.name]!=
null&&this.watcher.options[this.name]===!1)return!1;d=!1,e=a.get(0).nodeName,k=this.nodeNames;for(g=0,i=k.length;g<i;g++){f=k[g];if(e===f){d=!0;break}}if(!d)return!1;c=!0,l=this.classNames;for(h=0,j=l.
length;h<j;h++){b=l[h];if(!a.hasClass(b)){c=!1;break}}return c},b}(),a.Decorator=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.name="Decorator",b.prototype
.decorate=function(a,b){return{input:b}},b}(a._ElementWatcher),a.Validator=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.name="Validator",b.prototype.nodeNames=
["INPUT","TEXTAREA","SELECT"],b.prototype.validate=function(a,b){return!0},b.prototype.sanitize=function(a){return a},b}(a._ElementWatcher),a.defaultOptions={ajax:!1,ajaxMethod:null,validate:!0,submitOnChange
:!1,submitUnchanged:!0,submitFormIfAllUnchanged:!1,resetFormAfterSubmit:!1,automatchLabel:!0,responseCheck:function(a){return!a},onSubmit:function(){},onSuccess:function(a){},onError:function(a){return alert
(a)}},a.options={},b=function(){function b(b,d){var e,f,g,h,i,j,k,l,m,n,o,p=this;this.form=typeof b=="string"?$("#"+b):$(b);if(this.form.length<1)throw"Form element not found.";if(this.form.length>1)throw"More than one form was found."
;if(this.form.get(0).nodeName!=="FORM")throw"The element was not a form.";this.allElements=[],this.id=a.currentWatcherId++,a.add(this),this.observers={},this.form.fwData("watcher",this),this.form.fwData
("originalAction",this.form.attr("action")||"").attr("action","javascript:undefined;"),this.options=a.deepExtend({},a.defaultOptions,d||{}),this.decorators=[],this.validators=[],m=a.decorators;for(i=0,
k=m.length;i<k;i++)e=m[i],this.decorators.push(new e(this));n=a.validators;for(j=0,l=n.length;j<l;j++)f=n[j],this.validators.push(new f(this));this.options.ajaxMethod===null&&(this.options.ajaxMethod=(
o=this.form.attr("method"))!=null?o.toLowerCase():void 0);switch(this.options.ajaxMethod){case"post":case"put":case"delete":break;default:this.options.ajaxMethod="get"}this.observe("submit",this.options
.onSubmit),this.observe("success",this.options.onSuccess),this.observe("error",this.options.onError),$(c,this.form).each(function(b){var c,d,e,f,g,h,i,j,k,l,m,n;b=$(b);if(!b.fwData("initialized")){if(b
.attr("type")==="hidden")return b.fwData("forceSubmission",!0);d=a.decorate(p,b),d.input.get()!==b.get()&&(d.input.attr("class",b.attr("class")),b=d.input),d.label||(g=a.getLabel(d,p.options.automatchLabel
),g&&(d.label=g)),d.errors||(e=a.getErrorsElement(d,!0),d.errors=e),p.allElements.push(d),b.fwData("validators",[]),m=p.validators;for(k=0,l=m.length;k<l;k++)j=m[k],j.accepts(b,p)&&(a.debug('Validator "'+
j.name+'" found for input field "'+b.attr("name")+'".'),b.fwData("validators").push(j));a.storeInitialValue(d);if(b.val()===null||!b.val())for(f in d)c=d[f],c.addClass("empty");p.options.submitUnchanged||
a.removeName(d),h=function(){return a.changed(d,p)},i=function(){return p.validateElements(d,!0)},n=[];for(f in d)c=d[f],n.push(function(a){var b=this;return a.on("focus",function(){return a.addClass("focus"
)}),a.on("blur",function(){return a.removeClass("focus")}),a.on("change",h),a.on("blur",h),a.on("keyup",i)}(c));return n}}),h=$("input[type=submit], button[type=''], button[type='submit'], button:not([type])"
,this.form),g=$.create('<input type="hidden" name="" value="" />'),this.form.append(g),h.each(function(a){return a=$(a),a.click(function(b){return g.attr("name",a.attr("name")||"").attr("value",a.attr("value"
)||""),p.submitForm(),b.stopPropagation()})})}return b.name="Watcher",b.prototype.callObservers=function(){var a,b,c,e,f,g,h;b=arguments[0],a=2<=arguments.length?d.call(arguments,1):[],g=this.observers
[b],h=[];for(e=0,f=g.length;e<f;e++)c=g[e],h.push(c.apply(this,a));return h},b.prototype.observe=function(a,b){return this.observers[a]===undefined&&(this.observers[a]=[]),this.observers[a].push(b),this
},b.prototype.stopObserving=function(a,b){var c;return this.observers[a]=function(){var d,e,f,g;f=this.observers[a],g=[];for(d=0,e=f.length;d<e;d++)c=f[d],c!==b&&g.push(c);return g}.call(this),this},b.
prototype.enableForm=function(){return $(c,this.form).removeAttr("disabled")},b.prototype.disableForm=function(){return $(c,this.form).attr("disabled","disabled")},b.prototype.submitForm=function(a){var b=
this;if(!this.options.validate||this.validateForm())return this.callObservers("submit"),this.options.ajax?(this.disableForm(),this.submitAjax()):(this.form.attr("action",this.form.fwData("originalAction"
)),setTimeout(function(){return b.form.submit(),b.disableForm()},1),!1)},b.prototype.validateForm=function(){var a,b,c,d,e;b=!0,e=this.allElements;for(c=0,d=e.length;c<d;c++)a=e[c],this.validateElements
(a)||(b=!1);return b},b.prototype.validateElements=function(b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q;g=b.input,i=!0;if(g.fwData("validators").length){if(!c||!g.fwData("lastValidatedValue")||g.fwData("lastValidatedValue"
)!==g.val()){g.fwData("lastValidatedValue",g.val()),a.debug("Validating input "+g.attr("name")),g.fwData("validationErrors",[]),p=g.fwData("validators");for(l=0,n=p.length;l<n;l++){k=p[l];if(g.val()===""&&
k.name!=="Required"){a.debug("Validating "+k.name+". Field was empty so continuing.");continue}a.debug("Validating "+k.name),j=k.validate(k.sanitize(g.val()),g);if(j!==!0){i=!1,g.fwData("validationErrors"
).push(j);break}}if(i){b.errors.html("").hide();for(f in b){if(!e.call(b,f))continue;d=b[f],d.addClass("validated"),d.removeClass("error")}c&&b.input.fwData("forceValidationOnChange",!0)}else{for(f in 
b){if(!e.call(b,f))continue;d=b[f],d.removeClass("validated")}if(!c){b.errors.html(g.fwData("validationErrors").join("<br />")).show();for(f in b){if(!e.call(b,f))continue;d=b[f],d.addClass("error")}}}
}if(!c&&i){h=g.fwData("lastValidatedValue"),q=g.fwData("validators");for(m=0,o=q.length;m<o;m++)k=q[m],h=k.sanitize(h);g.val(h)}}else for(f in b){if(!e.call(b,f))continue;d=b[f],d.addClass("validated")
}return i},b.prototype.submitAjax=function(){var b,d,e,f=this;return a.debug("Submitting form via AJAX."),d={},b=0,e=0,$(c,this.form).each(function(a,c){var e,g;a=$(a);if(a[0].nodeName==="BUTTON"||a[0]
.nodeName==="INPUT"&&(a.attr("type").toLowerCase()==="submit"||a.attr("type").toLowerCase()==="button"))return;if(a.fwData("forceSubmission")||a.attr("type")==="checkbox"||a.fwData("changed")||f.options
.submitUnchanged)if(a.attr("type")!=="checkbox"||a.get(0).checked)return b++,e=(g=a.attr("name"))!=null?g:"unnamedInput_"+c,d[e]=a.val()}),b===0&&!this.options.submitFormIfAllUnchanged?setTimeout(function(
){return f.enableForm(),f.ajaxSuccess()},1):$.ajax({url:this.form.fwData("originalAction"),method:this.options.ajaxMethod,data:d,type:"text",error:function(a){return f.callObservers("error",a.response)
},success:function(a){return f.enableForm(),f.options.responseCheck(a.response)?(f.callObservers("success",a.response),f.ajaxSuccess()):f.callObservers("error",a.response)}})},b.prototype.ajaxSuccess=function(
){var b,c,d,e,f,g,h,i;h=this.allElements,i=[];for(f=0,g=h.length;f<g;f++)c=h[f],a.unsetChanged(c,this),this.options.resetFormAfterSubmit?a.restoreInitialValue(c):a.storeInitialValue(c),e=c.input.val()===
null||!c.input.val(),i.push(function(){var a;a=[];for(d in c)b=c[d],e?a.push(b.addClass("empty")):a.push(b.removeClass("empty"));return a}());return i},b}(),typeof window!="undefined"&&window!==null&&(
window.Formwatcher=a,window.Watcher=b),$.domReady(function(){return a.scanDocument()})})).call(this);// Generated by CoffeeScript 1.3.1
((function(){var a,b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new 
e,a.__super__=c.prototype,a};a=function(a){return a.replace(/^\s.*\s$/,"")},Formwatcher.validators.push(function(b){function d(){return d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype
.name="Integer",d.prototype.description="Makes sure a value is an integer",d.prototype.classNames=["validate-integer"],d.prototype.validate=function(a){return a.replace(/\d*/,"")!==""?"Has to be a number."
:!0},d.prototype.sanitize=function(b){return a(b)},d}(Formwatcher.Validator)),Formwatcher.validators.push(function(b){function d(){return d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype
.name="Required",d.prototype.description="Makes sure the value is not blank (nothing or spaces).",d.prototype.classNames=["required"],d.prototype.validate=function(b,c){return c.attr("type")==="checkbox"&&!
c.is(":checked")||!a(b)?"Can not be blank.":!0},d}(Formwatcher.Validator)),Formwatcher.validators.push(function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype
.name="NotZero",b.prototype.description="Makes sure the value is not 0.",b.prototype.classNames=["not-zero"],b.prototype.validate=function(a){var b;return b=parseInt(a),!isNaN(b)&&b===0?"Can not be 0."
:!0},b}(Formwatcher.Validator)),Formwatcher.validators.push(function(b){function d(){return d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.name="Email",d.prototype.description="Makes sure the value is an email."
,d.prototype.classNames=["validate-email"],d.prototype.validate=function(a){var b;return b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
,a.match(b)?!0:"Must be a valid email address."},d.prototype.sanitize=function(b){return a(b)},d}(Formwatcher.Validator)),Formwatcher.validators.push(function(b){function d(){return d.__super__.constructor
.apply(this,arguments)}return c(d,b),d.prototype.name="Float",d.prototype.description="Makes sure a value is a float",d.prototype.classNames=["validate-float"],d.prototype.defaultOptions={decimalMark:","
},d.prototype.validate=function(a){var b;return b=new RegExp("\\d+(\\"+this.options.decimalMark+"\\d+)?"),a.replace(b,"")!==""?"Has to be a number.":!0},d.prototype.sanitize=function(b){return b.indexOf
(".")>=0&&b.indexOf(",")>=0&&(b.lastIndexOf(",")>b.lastIndexOf(".")?b=b.replace(/\./g,""):b=b.replace(/\,/g,"")),b.indexOf(",")>=0&&(b=b.replace(/\,/g,".")),b.indexOf(".")!==b.lastIndexOf(".")&&(b=b.replace
(/\./g,"")),b=b.replace(/\./g,this.options.decimalMark),a(b)},d}(Formwatcher.Validator))})).call(this);// Generated by CoffeeScript 1.3.1
((function(){var a={}.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new 
e,b.__super__=c.prototype,b};Formwatcher.decorators.push(function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.name="Hint",c.prototype.description="Displays a hint in an input field."
,c.prototype.nodeNames=["INPUT","TEXTAREA"],c.prototype.defaultOptions={auto:!0,removeTrailingColon:!0,color:"#aaa"},c.prototype.decParseInt=function(a){return parseInt(a,10)},c.prototype.accepts=function(
a){if(c.__super__.accepts.call(this,a))if(a.data("hint")!=null||this.options.auto&&Formwatcher.getLabel({input:a},this.watcher.options.automatchLabel))return!0;return!1},c.prototype.decorate=function(a
){var b,c,d,e,f,g,h,i,j,k,l,m,n=this;d={input:a},f=a.data("hint");if(f==null||!f){i=Formwatcher.getLabel(d,this.watcher.options.automatchLabel);if(!i)throw"The hint was empty, but there was no label.";
d.label=i,i.hide(),f=i.html(),this.options.removeTrailingColon&&(f=f.replace(/\s*\:\s*$/,""))}return Formwatcher.debug("Using hint: "+f),m=$.create('<span style="display: inline-block; position: relative;" />'
),m.insertAfter(a),m.append(a),h={left:a[0].offsetLeft,top:a[0].offsetTop,width:a[0].offsetWidth,height:a[0].offsetHeight},j=this.decParseInt(a.css("paddingLeft"))+this.decParseInt(h.left)+this.decParseInt
(a.css("borderLeftWidth"))+2+"px",l=this.decParseInt(a.css("paddingTop"))+this.decParseInt(h.top)+this.decParseInt(a.css("borderTopWidth"))+"px",g=$.create("<span />").html(f).css({position:"absolute",
display:"none",top:l,left:j,fontSize:a.css("fontSize"),lineHeight:a.css("lineHeight"),fontFamily:a.css("fontFamily"),color:this.options.color}).addClass("hint").on("click",function(){return a[0].focus(
)}).insertAfter(a),e=100,a.focusin(function(){if(a.val()==="")return g.animate({opacity:.4,duration:e})}),a.focusout(function(){if(a.val()==="")return g.animate({opacity:1,duration:e})}),b=function(){return a
.val()===""?g.show():g.hide()},a.keyup(b),a.keypress(function(){return setTimeout(function(){return b()},1)}),a.keydown(function(){return setTimeout(function(){return b()},1)}),a.change(b),k=10,c=function(
){return b(),setTimeout(function(){return c()},k),k*=2,k=k>1e4?1e4:k},c(),d},c}(Formwatcher.Decorator))})).call(this);