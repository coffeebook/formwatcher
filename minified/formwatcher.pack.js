// Generated by CoffeeScript 1.3.1
((function(){var a,b,c,d,e=[].slice,f={}.hasOwnProperty,g=function(a,b){function d(){this.constructor=a}for(var c in b)f.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype
,a.prototype=new d,a.__super__=b.prototype,a};a=ender,a.ender({fwData:function(a,b){var c;return this.data("_formwatcher")==null&&this.data("_formwatcher",{}),a==null?this:(c=this.data("_formwatcher"),
b!=null?(c[a]=b,this.data("_formwatcher",c),this):c[a])}},!0),d="input, textarea, select, button",b={version:"2.1.4-dev",debugging:!1,debug:function(){if(this.debugging&&(typeof console!=="undefined"&&
console!==null?console.debug:void 0)!=null)return console.debug.apply(console,arguments)},getErrorsElement:function(b,c){var d,e;e=b.input,e.attr("name")&&(d=a("#"+e.attr("name")+"-errors")),(d!=null?d
.length:void 0)||!e.attr("id")||(d=a("#"+e.attr("id")+"-errors"));if(!d||!d.length)d=a.create("<span />"),e.attr("name")&&d.attr("id",e.attr("name")+"-errors"),d.insertAfter(e);return d.hide().addClass
("errors").addClass("fw-errors"),d},deepExtend:function(){var a,b,c,d,g,h,i;c=arguments[0],a=2<=arguments.length?e.call(arguments,1):[];if(c==null)return{};for(h=0,i=a.length;h<i;h++){d=a[h];for(b in d
){if(!f.call(d,b))continue;g=d[b],c[b]==null||typeof g!="object"?c[b]=g:c[b]=this.deepExtend(c[b],g)}}return c},getLabel:function(b,c){var d,e;d=b.input,e=void 0,d.attr("id")&&(e=a("label[for="+d.attr("id"
)+"]"),e.length||(e=undefined));if(!e&&c){e=d.previous(),window.testinput=d;if(!e.length||e.get(0).nodeName!=="LABEL"||e.attr("for")!=null)e=void 0}return e},changed:function(a,c){var d;d=a.input;if(!d
.fwData("forceValidationOnChange")&&d.attr("type")==="checkbox"&&d.fwData("previouslyChecked")===!!d[0].checked||d.fwData("previousValue")===d.val())return;d.fwData("forceValidationOnChange",!1),this.setPreviousValueToCurrentValue
(a),d.attr("type")==="checkbox"&&d.fwData("initialyChecked")!==!!d[0].checked||d.attr("type")!=="checkbox"&&d.fwData("initialValue")!==d.val()?b.setChanged(a,c):b.unsetChanged(a,c);if(c.options.validate
)return c.validateElements(a)},setChanged:function(a,c){var d,e,g;g=a.input;if(g.fwData("changed"))return;for(e in a){if(!f.call(a,e))continue;d=a[e],d.addClass("changed")}g.fwData("changed",!0),c.options
.submitUnchanged||b.restoreName(a);if(c.options.submitOnChange&&c.options.ajax)return c.submitForm()},unsetChanged:function(a,c){var d,e,g;g=a.input;if(!g.fwData("changed"))return;for(e in a){if(!f.call
(a,e))continue;d=a[e],d.removeClass("changed")}g.fwData("changed",!1);if(!c.options.submitUnchanged)return b.removeName(a)},storeInitialValue:function(a){var b;return b=a.input,b.attr("type")==="checkbox"?
b.fwData("initialyChecked",!!b[0].checked):b.fwData("initialValue",b.val()),this.setPreviousValueToInitialValue(a)},restoreInitialValue:function(a){var b;return b=a.input,b.attr("type")==="checkbox"?b.
attr("checked",b.fwData("initialyChecked")):b.val(b.fwData("initialValue")),this.setPreviousValueToInitialValue(a)},setPreviousValueToInitialValue:function(a){var b;return b=a.input,b.attr("type")==="checkbox"?
b.fwData("previouslyChecked",b.fwData("initialyChecked")):b.fwData("previousValue",b.fwData("initialValue"))},setPreviousValueToCurrentValue:function(a){var b;return b=a.input,b.attr("type")==="checkbox"?
b.fwData("previouslyChecked",!!b[0].checked):b.fwData("previousValue",b.val())},removeName:function(a){var b;b=a.input;if(b.attr("type")==="checkbox")return;return b.fwData("name")||b.fwData("name",b.attr
("name")||""),b.attr("name","")},restoreName:function(a){var b;b=a.input;if(b.attr("type")==="checkbox")return;return b.attr("name",b.fwData("name"))},decorators:[],decorate:function(a,c){var d,e,f,g,h
;e=null,h=a.decorators;for(f=0,g=h.length;f<g;f++){d=h[f];if(d.accepts(c)){e=d;break}}return e?(b.debug('Decorator "'+e.name+'" found for input field "'+c.attr("name")+'".'),e.decorate(c)):{input:c}},validators
:[],currentWatcherId:0,watchers:[],add:function(a){return this.watchers[a.id]=a},get:function(a){return this.watchers[a]},getAll:function(){return this.watchers},scanDocument:function(){var d,e,f,g=this
;e=function(d){var e,f,h;d=a(d);if(d.fwData("watcher"))return;return f=d.attr("id"),h=f!=null&&b.options[f]!=null?b.options[f]:{},e=d.data("fw"),e&&(h=g.deepExtend(h,JSON.parse(e))),new c(d,h)},a("form[data-fw]"
).each(function(a){return e(a)}),f=[];for(d in b.options)f.push(e(a("#"+d)));return f},watch:function(b,d){return a.domReady(function(){return new c(b,d)})}},b._ElementWatcher=function(){function a(a){
var c;this.watcher=a,this.options=b.deepExtend({},this.defaultOptions,(c=a.options[this.name])!=null?c:{})}return a.name="_ElementWatcher",a.prototype.name="No name",a.prototype.description="No description"
,a.prototype.nodeNames=null,a.prototype.classNames=[],a.prototype.defaultOptions={},a.prototype.options=null,a.prototype.accepts=function(a){var b,c,d,e,f,g,h,i,j,k,l;if(this.watcher.options[this.name]!=
null&&this.watcher.options[this.name]===!1)return!1;d=!1,e=a.get(0).nodeName,k=this.nodeNames;for(g=0,i=k.length;g<i;g++){f=k[g];if(e===f){d=!0;break}}if(!d)return!1;c=!0,l=this.classNames;for(h=0,j=l.
length;h<j;h++){b=l[h];if(!a.hasClass(b)){c=!1;break}}return c},a}(),b.Decorator=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.name="Decorator",b.prototype
.decorate=function(a,b){return{input:b}},b}(b._ElementWatcher),b.Validator=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.name="Validator",b.prototype.nodeNames=
["INPUT","TEXTAREA","SELECT"],b.prototype.validate=function(a,b){return!0},b.prototype.sanitize=function(a){return a},b}(b._ElementWatcher),b.defaultOptions={ajax:!1,ajaxMethod:null,validate:!0,submitOnChange
:!1,submitUnchanged:!0,submitFormIfAllUnchanged:!1,resetFormAfterSubmit:!1,automatchLabel:!0,responseCheck:function(a){return!a},onSubmit:function(){},onSuccess:function(a){},onError:function(a){return alert
(a)}},b.options={},c=function(){function c(c,e){var f,g,h,i,j,k,l,m,n,o,p,q=this;this.form=typeof c=="string"?a("#"+c):a(c);if(this.form.length<1)throw"Form element not found.";if(this.form.length>1)throw"More than one form was found."
;if(this.form.get(0).nodeName!=="FORM")throw"The element was not a form.";this.allElements=[],this.id=b.currentWatcherId++,b.add(this),this.observers={},this.form.fwData("watcher",this),this.form.fwData
("originalAction",this.form.attr("action")||"").attr("action","javascript:undefined;"),this.options=b.deepExtend({},b.defaultOptions,e||{}),this.decorators=[],this.validators=[],n=b.decorators;for(j=0,
l=n.length;j<l;j++)f=n[j],this.decorators.push(new f(this));o=b.validators;for(k=0,m=o.length;k<m;k++)g=o[k],this.validators.push(new g(this));this.options.ajaxMethod===null&&(this.options.ajaxMethod=(
p=this.form.attr("method"))!=null?p.toLowerCase():void 0);switch(this.options.ajaxMethod){case"post":case"put":case"delete":break;default:this.options.ajaxMethod="get"}this.observe("submit",this.options
.onSubmit),this.observe("success",this.options.onSuccess),this.observe("error",this.options.onError),a(d,this.form).each(function(c){var d,e,f,g,h,i,j,k,l,m,n,o;c=a(c);if(!c.fwData("initialized")){if(c
.attr("type")==="hidden")return c.fwData("forceSubmission",!0);e=b.decorate(q,c),e.input.get()!==c.get()&&(e.input.attr("class",c.attr("class")),c=e.input),e.label||(h=b.getLabel(e,q.options.automatchLabel
),h&&(e.label=h)),e.errors||(f=b.getErrorsElement(e,!0),e.errors=f),q.allElements.push(e),c.fwData("validators",[]),n=q.validators;for(l=0,m=n.length;l<m;l++)k=n[l],k.accepts(c,q)&&(b.debug('Validator "'+
k.name+'" found for input field "'+c.attr("name")+'".'),c.fwData("validators").push(k));b.storeInitialValue(e);if(c.val()===null||!c.val())for(g in e)d=e[g],d.addClass("empty");q.options.submitUnchanged||
b.removeName(e),i=function(){return b.changed(e,q)},j=function(){return q.validateElements(e,!0)},o=[];for(g in e)d=e[g],o.push(function(a){var b=this;return a.on("focus",function(){return a.addClass("focus"
)}),a.on("blur",function(){return a.removeClass("focus")}),a.on("change",i),a.on("blur",i),a.on("keyup",j)}(d));return o}}),i=a("input[type=submit], button[type=''], button[type='submit'], button:not([type])"
,this.form),h=a.create('<input type="hidden" name="" value="" />'),this.form.append(h),i.each(function(b){return b=a(b),b.click(function(a){var c,d,e,f;return b[0].tagName==="BUTTON"?(d=b.text(),b.text
(""),c=(e=b.val())!=null?e:"",b.text(d)):c=(f=b.val())!=null?f:"",h.attr("name",b.attr("name")||"").val(c),q.submitForm(),a.stopPropagation()})})}return c.name="Watcher",c.prototype.callObservers=function(
){var a,b,c,d,f,g,h;b=arguments[0],a=2<=arguments.length?e.call(arguments,1):[],g=this.observers[b],h=[];for(d=0,f=g.length;d<f;d++)c=g[d],h.push(c.apply(this,a));return h},c.prototype.observe=function(
a,b){return this.observers[a]===undefined&&(this.observers[a]=[]),this.observers[a].push(b),this},c.prototype.stopObserving=function(a,b){var c;return this.observers[a]=function(){var d,e,f,g;f=this.observers
[a],g=[];for(d=0,e=f.length;d<e;d++)c=f[d],c!==b&&g.push(c);return g}.call(this),this},c.prototype.enableForm=function(){return a(d,this.form).removeAttr("disabled")},c.prototype.disableForm=function()
{return a(d,this.form).attr("disabled","disabled")},c.prototype.submitForm=function(a){var b=this;if(!this.options.validate||this.validateForm())return this.callObservers("submit"),this.options.ajax?(this
.disableForm(),this.submitAjax()):(this.form.attr("action",this.form.fwData("originalAction")),setTimeout(function(){return b.form.submit(),b.disableForm()},1),!1)},c.prototype.validateForm=function(){
var a,b,c,d,e;b=!0,e=this.allElements;for(c=0,d=e.length;c<d;c++)a=e[c],this.validateElements(a)||(b=!1);return b},c.prototype.validateElements=function(a,c){var d,e,g,h,i,j,k,l,m,n,o,p,q;g=a.input,i=!0
;if(g.fwData("validators").length){if(!c||!g.fwData("lastValidatedValue")||g.fwData("lastValidatedValue")!==g.val()){g.fwData("lastValidatedValue",g.val()),b.debug("Validating input "+g.attr("name")),g
.fwData("validationErrors",[]),p=g.fwData("validators");for(l=0,n=p.length;l<n;l++){k=p[l];if(g.val()===""&&k.name!=="Required"){b.debug("Validating "+k.name+". Field was empty so continuing.");continue}
b.debug("Validating "+k.name),j=k.validate(k.sanitize(g.val()),g);if(j!==!0){i=!1,g.fwData("validationErrors").push(j);break}}if(i){a.errors.html("").hide();for(e in a){if(!f.call(a,e))continue;d=a[e],
d.addClass("validated"),d.removeClass("error")}c&&a.input.fwData("forceValidationOnChange",!0)}else{for(e in a){if(!f.call(a,e))continue;d=a[e],d.removeClass("validated")}if(!c){a.errors.html(g.fwData("validationErrors"
).join("<br />")).show();for(e in a){if(!f.call(a,e))continue;d=a[e],d.addClass("error")}}}}if(!c&&i){h=g.fwData("lastValidatedValue"),q=g.fwData("validators");for(m=0,o=q.length;m<o;m++)k=q[m],h=k.sanitize
(h);g.val(h)}}else for(e in a){if(!f.call(a,e))continue;d=a[e],d.addClass("validated")}return i},c.prototype.submitAjax=function(){var c,e,f,g=this;return b.debug("Submitting form via AJAX."),e={},c=0,
f=0,a(d,this.form).each(function(b,d){var f,h;b=a(b);if(b[0].nodeName==="BUTTON"||b[0].nodeName==="INPUT"&&(b.attr("type").toLowerCase()==="submit"||b.attr("type").toLowerCase()==="button"))return;if(b
.fwData("forceSubmission")||b.attr("type")==="checkbox"||b.fwData("changed")||g.options.submitUnchanged)if(b.attr("type")!=="checkbox"||b.get(0).checked)return c++,f=(h=b.attr("name"))!=null?h:"unnamedInput_"+
d,e[f]=b.val()}),c===0&&!this.options.submitFormIfAllUnchanged?setTimeout(function(){return g.enableForm(),g.ajaxSuccess()},1):a.ajax({url:this.form.fwData("originalAction"),method:this.options.ajaxMethod
,data:e,type:"text",error:function(a){return g.callObservers("error",a.response)},success:function(a){return g.enableForm(),g.options.responseCheck(a.response)?(g.callObservers("success",a.response),g.
ajaxSuccess()):g.callObservers("error",a.response)}})},c.prototype.ajaxSuccess=function(){var a,c,d,e,f,g,h,i;h=this.allElements,i=[];for(f=0,g=h.length;f<g;f++)c=h[f],b.unsetChanged(c,this),this.options
.resetFormAfterSubmit?b.restoreInitialValue(c):b.storeInitialValue(c),e=c.input.val()===null||!c.input.val(),i.push(function(){var b;b=[];for(d in c)a=c[d],e?b.push(a.addClass("empty")):b.push(a.removeClass
("empty"));return b}());return i},c}(),typeof window!="undefined"&&window!==null&&(window.Formwatcher=b,window.Watcher=c),a.domReady(function(){return b.scanDocument()})})).call(this);// Generated by CoffeeScript 1.3.1
((function(){var a,b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new 
e,a.__super__=c.prototype,a};a=function(a){return a.replace(/^\s.*\s$/,"")},Formwatcher.validators.push(function(b){function d(){return d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype
.name="Integer",d.prototype.description="Makes sure a value is an integer",d.prototype.classNames=["validate-integer"],d.prototype.validate=function(a){return a.replace(/\d*/,"")!==""?"Has to be a number."
:!0},d.prototype.sanitize=function(b){return a(b)},d}(Formwatcher.Validator)),Formwatcher.validators.push(function(b){function d(){return d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype
.name="Required",d.prototype.description="Makes sure the value is not blank (nothing or spaces).",d.prototype.classNames=["required"],d.prototype.validate=function(b,c){return c.attr("type")==="checkbox"&&!
c.is(":checked")||!a(b)?"Can not be blank.":!0},d}(Formwatcher.Validator)),Formwatcher.validators.push(function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype
.name="NotZero",b.prototype.description="Makes sure the value is not 0.",b.prototype.classNames=["not-zero"],b.prototype.validate=function(a){var b;return b=parseInt(a),!isNaN(b)&&b===0?"Can not be 0."
:!0},b}(Formwatcher.Validator)),Formwatcher.validators.push(function(b){function d(){return d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.name="Email",d.prototype.description="Makes sure the value is an email."
,d.prototype.classNames=["validate-email"],d.prototype.validate=function(a){var b;return b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
,a.match(b)?!0:"Must be a valid email address."},d.prototype.sanitize=function(b){return a(b)},d}(Formwatcher.Validator)),Formwatcher.validators.push(function(b){function d(){return d.__super__.constructor
.apply(this,arguments)}return c(d,b),d.prototype.name="Float",d.prototype.description="Makes sure a value is a float",d.prototype.classNames=["validate-float"],d.prototype.defaultOptions={decimalMark:","
},d.prototype.validate=function(a){var b;return b=new RegExp("\\d+(\\"+this.options.decimalMark+"\\d+)?"),a.replace(b,"")!==""?"Has to be a number.":!0},d.prototype.sanitize=function(b){return b.indexOf
(".")>=0&&b.indexOf(",")>=0&&(b.lastIndexOf(",")>b.lastIndexOf(".")?b=b.replace(/\./g,""):b=b.replace(/\,/g,"")),b.indexOf(",")>=0&&(b=b.replace(/\,/g,".")),b.indexOf(".")!==b.lastIndexOf(".")&&(b=b.replace
(/\./g,"")),b=b.replace(/\./g,this.options.decimalMark),a(b)},d}(Formwatcher.Validator))})).call(this);// Generated by CoffeeScript 1.3.1
((function(){var a,b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new 
e,a.__super__=c.prototype,a};a=ender,Formwatcher.decorators.push(function(b){function d(){return d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.name="Hint",d.prototype.description="Displays a hint in an input field."
,d.prototype.nodeNames=["INPUT","TEXTAREA"],d.prototype.defaultOptions={auto:!0,removeTrailingColon:!0,color:"#aaa"},d.prototype.decParseInt=function(a){return parseInt(a,10)},d.prototype.accepts=function(
a){if(d.__super__.accepts.call(this,a))if(a.data("hint")!=null||this.options.auto&&Formwatcher.getLabel({input:a},this.watcher.options.automatchLabel))return!0;return!1},d.prototype.decorate=function(b
){var c,d,e,f,g,h,i,j,k,l,m,n,o=this;e={input:b},g=b.data("hint");if(g==null||!g){j=Formwatcher.getLabel(e,this.watcher.options.automatchLabel);if(!j)throw"The hint was empty, but there was no label.";
e.label=j,j.hide(),g=j.html(),this.options.removeTrailingColon&&(g=g.replace(/\s*\:\s*$/,""))}return Formwatcher.debug("Using hint: "+g),n=a.create('<span style="display: inline-block; position: relative;" />'
),n.insertAfter(b),n.append(b),i={left:b[0].offsetLeft,top:b[0].offsetTop,width:b[0].offsetWidth,height:b[0].offsetHeight},k=this.decParseInt(b.css("paddingLeft"))+this.decParseInt(i.left)+this.decParseInt
(b.css("borderLeftWidth"))+2+"px",m=this.decParseInt(b.css("paddingTop"))+this.decParseInt(i.top)+this.decParseInt(b.css("borderTopWidth"))+"px",h=a.create("<span />").html(g).css({position:"absolute",
display:"none",top:m,left:k,fontSize:b.css("fontSize"),lineHeight:b.css("lineHeight"),fontFamily:b.css("fontFamily"),color:this.options.color}).addClass("hint").on("click",function(){return b[0].focus(
)}).insertAfter(b),f=100,b.focusin(function(){if(b.val()==="")return h.animate({opacity:.4,duration:f})}),b.focusout(function(){if(b.val()==="")return h.animate({opacity:1,duration:f})}),c=function(){return b
.val()===""?h.show():h.hide()},b.keyup(c),b.keypress(function(){return setTimeout(function(){return c()},1)}),b.keydown(function(){return setTimeout(function(){return c()},1)}),b.change(c),l=10,d=function(
){return c(),setTimeout(function(){return d()},l),l*=2,l=l>1e4?1e4:l},d(),e},d}(Formwatcher.Decorator))})).call(this);